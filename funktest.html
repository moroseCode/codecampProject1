<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
    var cityID = "";
    jQuery.ajaxPrefilter(function(options) {
    if (options.crossDomain && jQuery.support.cors) {
        options.url = 'https://cors-anywhere.herokuapp.com/' + options.url;
    }
    });
        // $.ajax(settings).done(function (response) {
        //     console.log(response.results);
        // });
    var startDate = "2019-09-24.."

    var activeParams = {
        "api_key": "yfb8tzs47k5z8j9463emhphv",
        "query":    "golf",
        "near": "richmond,va,us",
        "radius": "25",
        "start_date": startDate
    }
    
    var queryURL = "http://api.amp.active.com/v2/search";
    
    $.ajax({
        url: queryURL,
        method: "GET",
        data: activeParams
        }).then(function(response) {
        var results = response.results;
        var testResult = results[0]
        var recurrences = testResult.activityRecurrences[0]
        console.log(results)
        console.log(testResult.assetComponents["0"].assetName)
        console.log(testResult.assetDescriptions["0"].description)
        console.log(testResult.registrationUrlAdr)
        console.log(recurrences.activityStartDate)
        console.log(recurrences.activityEndDate)
        console.log(recurrences.frequency.frequencyName)
        console.log(testResult.place.addressLine1Txt)
        console.log(testResult.place.cityName + ", " + testResult.place.stateProvinceCode)
        console.log(testResult.place.postalCode)
    });
        
    var coordsUrl = "https://dataservice.accuweather.com/locations/v1/cities/search"
    var locLat = "37.574433" //needs to be a variable from the info from the stuff Bishop is using
    var locLon = "-77.539932" //same as above
    var coordsParams = {
        "apikey": "0AJTGemJpazvUYpRY1sAuD3oMlYV26EA",
        "q": locLat + "," + locLon
    }

    $.ajax({
        "url": coordsUrl,
        "method": "GET",
        "data": coordsParams
    }).then(function (response) {
        console.log(response[0].Key)
        cityID = response[0].Key
        var weatherUrl = "https://dataservice.accuweather.com/forecasts/v1/daily/5day/" + cityID
        var weatherParams = {
            "apikey": "alDalbGMtcCLkMBINAb9QZKLDnGdExK6",
            "details": "true"
        }   
        console.log(cityID)
    });

    $.ajax({
        "url": weatherUrl,
        "method": "GET",
        "data": weatherParams
    }).then(function (response) {
        console.log(response.DailyForecasts)
        for(var i = 0; i < (response.DailyForecasts).length; i++){
            var weathDay = response.DailyForecasts[i]
            console.log("Rain Probability: " + weathDay.Day.RainProbability + "%");
            console.log("Low: " + weathDay.Temperature.Minimum.Value)
            console.log("High: " + weathDay.Temperature.Maximum.Value)
            console.log(weathDay.Day.LongPhrase)
            console.log(weathDay.Day.IconPhrase)
            console.log("--------------------------")
        }
    });
            
    </script>
</body>
</html>